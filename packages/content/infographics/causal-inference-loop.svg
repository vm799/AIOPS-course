<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600" width="800" height="600">
  <defs>
    <!-- Neon gradient -->
    <linearGradient id="neonGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#22D3EE;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#10B981;stop-opacity:1" />
    </linearGradient>

    <!-- Causal arrow gradient -->
    <linearGradient id="causalGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#22D3EE;stop-opacity:0.8" />
      <stop offset="100%" style="stop-color:#10B981;stop-opacity:0.8" />
    </linearGradient>

    <!-- Correlation (dashed) -->
    <linearGradient id="correlationGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#9CA3AF;stop-opacity:0.6" />
      <stop offset="100%" style="stop-color:#6B7280;stop-opacity:0.6" />
    </linearGradient>

    <!-- Filters -->
    <filter id="glow">
      <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>

    <filter id="shadow">
      <feDropShadow dx="0" dy="2" stdDeviation="2" flood-opacity="0.4"/>
    </filter>

    <!-- Arrow marker -->
    <marker id="causalArrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#22D3EE" />
    </marker>

    <marker id="correlationArrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#9CA3AF" />
    </marker>
  </defs>

  <!-- Background -->
  <rect width="800" height="600" fill="#0B0F14"/>

  <!-- Title -->
  <text x="400" y="30" font-family="system-ui, -apple-system, sans-serif" font-size="22" font-weight="700" fill="#E5E7EB" text-anchor="middle">
    Causal Inference: From Correlation to Root Cause
  </text>

  <!-- Correlation vs Causation explanation -->
  <g id="legend">
    <rect x="50" y="50" width="700" height="50" rx="6" fill="#111827" stroke="url(#neonGradient)" stroke-width="1"/>

    <line x1="80" y1="75" x2="140" y2="75" stroke="#22D3EE" stroke-width="2.5" marker-end="url(#causalArrow)"/>
    <text x="150" y="80" font-family="system-ui" font-size="12" fill="#E5E7EB">
      Causal relationship (A causes B)
    </text>

    <line x1="380" y1="75" x2="440" y2="75" stroke="#9CA3AF" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#correlationArrow)"/>
    <text x="450" y="80" font-family="system-ui" font-size="12" fill="#E5E7EB">
      Correlation only (no causation)
    </text>
  </g>

  <!-- Example: Memory Leak Cascade -->
  <text x="400" y="130" font-family="system-ui" font-size="16" font-weight="600" fill="#9CA3AF" text-anchor="middle">
    Example: Database Connection Leak RCA
  </text>

  <!-- Causal DAG (Directed Acyclic Graph) -->
  <g id="causal-graph">
    <!-- Node 1: Root Cause -->
    <rect x="320" y="155" width="160" height="50" rx="8" fill="#111827" stroke="#EF4444" stroke-width="2.5" filter="url(#glow)"/>
    <text x="400" y="175" font-family="system-ui" font-size="13" font-weight="700" fill="#EF4444" text-anchor="middle">
      ROOT CAUSE
    </text>
    <text x="400" y="193" font-family="system-ui" font-size="11" fill="#9CA3AF" text-anchor="middle">
      Code bug (connection leak)
    </text>

    <!-- Arrow down -->
    <path d="M 400 205 L 400 245" stroke="url(#causalGradient)" stroke-width="3" marker-end="url(#causalArrow)"/>
    <text x="420" y="230" font-family="system-ui" font-size="10" fill="#6B7280">
      causes
    </text>

    <!-- Node 2: Intermediate Effect 1 -->
    <rect x="320" y="250" width="160" height="50" rx="8" fill="#111827" stroke="#22D3EE" stroke-width="2" filter="url(#shadow)"/>
    <text x="400" y="270" font-family="system-ui" font-size="12" font-weight="600" fill="#22D3EE" text-anchor="middle">
      Memory Usage Increases
    </text>
    <text x="400" y="288" font-family="system-ui" font-size="10" fill="#9CA3AF" text-anchor="middle">
      14:03:00 (+5% baseline)
    </text>

    <!-- Arrow down -->
    <path d="M 400 300 L 400 340" stroke="url(#causalGradient)" stroke-width="3" marker-end="url(#causalArrow)"/>
    <text x="420" y="325" font-family="system-ui" font-size="10" fill="#6B7280">
      triggers
    </text>

    <!-- Node 3: Intermediate Effect 2 -->
    <rect x="320" y="345" width="160" height="50" rx="8" fill="#111827" stroke="#10B981" stroke-width="2" filter="url(#shadow)"/>
    <text x="400" y="365" font-family="system-ui" font-size="12" font-weight="600" fill="#10B981" text-anchor="middle">
      GC Frequency Increases
    </text>
    <text x="400" y="383" font-family="system-ui" font-size="10" fill="#9CA3AF" text-anchor="middle">
      14:04:30 (3× baseline)
    </text>

    <!-- Arrow down splits to two paths -->
    <path d="M 370 395 L 250 435" stroke="url(#causalGradient)" stroke-width="2.5" marker-end="url(#causalArrow)"/>
    <path d="M 430 395 L 550 435" stroke="url(#causalGradient)" stroke-width="2.5" marker-end="url(#causalArrow)"/>

    <!-- Node 4a: Observable Symptom (left) -->
    <rect x="100" y="440" width="160" height="50" rx="8" fill="#111827" stroke="#22D3EE" stroke-width="2" filter="url(#shadow)"/>
    <text x="180" y="460" font-family="system-ui" font-size="12" font-weight="600" fill="#22D3EE" text-anchor="middle">
      CPU Spikes
    </text>
    <text x="180" y="478" font-family="system-ui" font-size="10" fill="#9CA3AF" text-anchor="middle">
      14:05:00 (78% utilization)
    </text>

    <!-- Node 4b: Observable Symptom (right) -->
    <rect x="540" y="440" width="160" height="50" rx="8" fill="#111827" stroke="#10B981" stroke-width="2" filter="url(#shadow)"/>
    <text x="620" y="460" font-family="system-ui" font-size="12" font-weight="600" fill="#10B981" text-anchor="middle">
      Connection Pool Exhaustion
    </text>
    <text x="620" y="478" font-family="system-ui" font-size="10" fill="#9CA3AF" text-anchor="middle">
      14:08:00 (95% utilization)
    </text>

    <!-- Arrows converge to final symptom -->
    <path d="M 210 490 L 360 530" stroke="url(#causalGradient)" stroke-width="2.5" marker-end="url(#causalArrow)"/>
    <path d="M 590 490 L 440 530" stroke="url(#causalGradient)" stroke-width="2.5" marker-end="url(#causalArrow)"/>

    <!-- Node 5: Customer-Facing Impact -->
    <rect x="320" y="535" width="160" height="50" rx="8" fill="#111827" stroke="#EF4444" stroke-width="2.5" filter="url(#glow)"/>
    <text x="400" y="555" font-family="system-ui" font-size="13" font-weight="700" fill="#EF4444" text-anchor="middle">
      Error Rate Spikes
    </text>
    <text x="400" y="573" font-family="system-ui" font-size="10" fill="#9CA3AF" text-anchor="middle">
      14:12:00 (3.2% errors)
    </text>

    <!-- Correlation line (CPU to Errors) - no causation -->
    <path d="M 180 490 L 380 535" stroke="#9CA3AF" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#correlationArrow)" opacity="0.5"/>
    <text x="260" y="510" font-family="system-ui" font-size="9" fill="#6B7280" transform="rotate(-20 260 510)">
      correlation (r=0.82)
    </text>
  </g>

  <!-- RCA Process steps (right side) -->
  <g id="rca-steps">
    <rect x="50" y="155" width="240" height="415" rx="8" fill="#111827" stroke="url(#neonGradient)" stroke-width="1.5" filter="url(#shadow)"/>

    <text x="170" y="180" font-family="system-ui" font-size="14" font-weight="600" fill="#E5E7EB" text-anchor="middle">
      RCA Framework
    </text>

    <!-- Step 1 -->
    <circle cx="75" cy="210" r="5" fill="#22D3EE"/>
    <text x="90" y="215" font-family="system-ui" font-size="12" font-weight="600" fill="#22D3EE">
      1. Establish Timeline
    </text>
    <text x="90" y="232" font-family="system-ui" font-size="10" fill="#9CA3AF">
      Find earliest deviation
    </text>
    <text x="90" y="246" font-family="system-ui" font-size="9" fill="#6B7280">
      → Memory at 14:03
    </text>

    <!-- Step 2 -->
    <circle cx="75" cy="275" r="5" fill="#10B981"/>
    <text x="90" y="280" font-family="system-ui" font-size="12" font-weight="600" fill="#10B981">
      2. Identify Correlations
    </text>
    <text x="90" y="297" font-family="system-ui" font-size="10" fill="#9CA3AF">
      Find related signals
    </text>
    <text x="90" y="311" font-family="system-ui" font-size="9" fill="#6B7280">
      → Memory ↔ CPU (r=0.82)
    </text>

    <!-- Step 3 -->
    <circle cx="75" cy="340" r="5" fill="#22D3EE"/>
    <text x="90" y="345" font-family="system-ui" font-size="12" font-weight="600" fill="#22D3EE">
      3. Build Causal Hypothesis
    </text>
    <text x="90" y="362" font-family="system-ui" font-size="10" fill="#9CA3AF">
      Explain mechanism
    </text>
    <text x="90" y="376" font-family="system-ui" font-size="9" fill="#6B7280">
      → Leak → GC → CPU
    </text>

    <!-- Step 4 -->
    <circle cx="75" cy="405" r="5" fill="#10B981"/>
    <text x="90" y="410" font-family="system-ui" font-size="12" font-weight="600" fill="#10B981">
      4. Validate with Evidence
    </text>
    <text x="90" y="427" font-family="system-ui" font-size="10" fill="#9CA3AF">
      Confirm or refute
    </text>
    <text x="90" y="441" font-family="system-ui" font-size="9" fill="#6B7280">
      → Code review confirms
    </text>

    <!-- Step 5 -->
    <circle cx="75" cy="470" r="5" fill="#22D3EE"/>
    <text x="90" y="475" font-family="system-ui" font-size="12" font-weight="600" fill="#22D3EE">
      5. Eliminate Confounders
    </text>
    <text x="90" y="492" font-family="system-ui" font-size="10" fill="#9CA3AF">
      Rule out alternatives
    </text>
    <text x="90" y="506" font-family="system-ui" font-size="9" fill="#6B7280">
      → Traffic stable, no AWS issues
    </text>

    <!-- Conclusion -->
    <rect x="60" y="525" width="220" height="35" rx="4" fill="#0B0F14" stroke="#EF4444" stroke-width="1.5"/>
    <text x="170" y="548" font-family="system-ui" font-size="11" font-weight="600" fill="#EF4444" text-anchor="middle">
      ROOT CAUSE: Connection leak (89% confidence)
    </text>
  </g>
</svg>
